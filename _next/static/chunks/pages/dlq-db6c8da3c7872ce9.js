(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{1861:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dlq",function(){return t(3730)}])},39:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(3759).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},641:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(3759).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},4976:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(3759).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},163:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(3759).Z)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]])},9475:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(3759).Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},5695:function(e,s,t){"use strict";t.d(s,{Z:function(){return d}});var a=t(5893),r=t(7294),n=t(1163),l=t(837),i=t(641),c=t(5156);function d(e){let{children:s}=e,{isAuthenticated:t,loading:d}=(0,l.a)(),o=(0,n.useRouter)();return((0,r.useEffect)(()=>{d||t||o.push((0,c.D)("/login"))},[t,d,o]),d)?(0,a.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(i.Z,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})]})}):t?(0,a.jsx)(a.Fragment,{children:s}):null}},3730:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return b}});var a=t(5893),r=t(7294),n=t(9681),l=t(4976),i=t(9475),c=t(9200),d=t(163),o=t(39),x=t(5928),h=t(7864),m=t(2798),u=t(5695),j=t(8778),f=t(9346),p=t(4109),w=t(8860),y=t(4350),k=t(2378),N=t(6501);function b(){let[e,s]=(0,r.useState)([]),[t,b]=(0,r.useState)(!0),[v,g]=(0,r.useState)(null),[C,D]=(0,r.useState)({workflow:"",taskType:"",search:""});(0,r.useEffect)(()=>{T()},[]);let T=async()=>{try{b(!0);let e=[{id:"1",runId:"run-123",workflowId:"wf-1",nodeId:"node-1",status:"FAILED",input:{data:"test"},error:"Connection timeout after 30 seconds",retryCount:3,maxRetries:3,startedAt:new Date(Date.now()-36e5),completedAt:new Date(Date.now()-35e5),createdAt:new Date(Date.now()-36e5),updatedAt:new Date(Date.now()-35e5),nodeName:"HTTP Request",nodeType:"http",workflowName:"Order Processing Pipeline"},{id:"2",runId:"run-124",workflowId:"wf-2",nodeId:"node-2",status:"FAILED",input:{email:"test@example.com"},error:"Invalid email format",retryCount:2,maxRetries:3,startedAt:new Date(Date.now()-72e5),completedAt:new Date(Date.now()-71e5),createdAt:new Date(Date.now()-72e5),updatedAt:new Date(Date.now()-71e5),nodeName:"Send Email",nodeType:"email",workflowName:"Email Notification System"},{id:"3",runId:"run-125",workflowId:"wf-3",nodeId:"node-3",status:"FAILED",input:{webhook:"https://api.example.com/webhook"},error:"Webhook endpoint returned 500 error",retryCount:1,maxRetries:3,startedAt:new Date(Date.now()-108e5),completedAt:new Date(Date.now()-107e5),createdAt:new Date(Date.now()-108e5),updatedAt:new Date(Date.now()-107e5),nodeName:"Webhook Call",nodeType:"webhook",workflowName:"Data Sync Workflow"}];s(e)}catch(e){console.error("Failed to load DLQ tasks:",e),N.Am.error("Failed to load failed tasks")}finally{b(!1)}},A=async e=>{try{g(e),await m.x.retryTask(e),N.Am.success("Task retry initiated successfully"),T()}catch(e){console.error("Failed to retry task:",e),N.Am.error("Failed to retry task")}finally{g(null)}},Z=async e=>{if(confirm("Are you sure you want to permanently delete this failed task?"))try{s(s=>s.filter(s=>s.id!==e)),N.Am.success("Task deleted successfully")}catch(e){console.error("Failed to delete task:",e),N.Am.error("Failed to delete task")}},E=e=>e.includes("timeout")?"Timeout":e.includes("connection")?"Connection":e.includes("500")?"Server Error":e.includes("400")?"Bad Request":e.includes("Invalid")?"Validation":"Unknown",R=e=>{switch(E(e)){case"Timeout":return"bg-orange-500";case"Connection":return"bg-red-500";case"Server Error":return"bg-red-600";case"Bad Request":return"bg-yellow-500";case"Validation":return"bg-blue-500";default:return"bg-gray-500"}},S=(e||[]).filter(e=>(!C.workflow||"all"===C.workflow||e.workflowName===C.workflow)&&(!C.taskType||"all"===C.taskType||e.nodeType===C.taskType)&&(!C.search||!!e.error.toLowerCase().includes(C.search.toLowerCase()))),I=Array.from(new Set((e||[]).map(e=>e.workflowName).filter(Boolean))),F=Array.from(new Set((e||[]).map(e=>e.nodeType).filter(Boolean)));return(0,a.jsx)(u.Z,{children:(0,a.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,a.jsx)("header",{className:"border-b border-border/40 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,a.jsxs)("div",{className:"container flex h-16 items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Dead Letter Queue"}),(0,a.jsxs)(p.C,{variant:"destructive",className:"bg-red-500",children:[e.length," Failed Tasks"]})]}),(0,a.jsxs)(j.z,{onClick:T,disabled:t,children:[(0,a.jsx)(l.Z,{className:"mr-2 h-4 w-4 ".concat(t?"animate-spin":"")}),"Refresh"]})]})}),(0,a.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:(0,a.jsxs)(f.Zb,{children:[(0,a.jsxs)(f.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(f.ll,{className:"text-sm font-medium",children:"Total Failed Tasks"}),(0,a.jsx)(i.Z,{className:"h-4 w-4 text-red-500"})]}),(0,a.jsxs)(f.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-red-500",children:e.length}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Tasks in DLQ"})]})]})}),(0,a.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:(0,a.jsxs)(f.Zb,{children:[(0,a.jsxs)(f.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(f.ll,{className:"text-sm font-medium",children:"Max Retries Exceeded"}),(0,a.jsx)(c.Z,{className:"h-4 w-4 text-orange-500"})]}),(0,a.jsxs)(f.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-500",children:e.filter(e=>e.retryCount>=e.maxRetries).length}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Cannot retry"})]})]})}),(0,a.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:(0,a.jsxs)(f.Zb,{children:[(0,a.jsxs)(f.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(f.ll,{className:"text-sm font-medium",children:"Retryable Tasks"}),(0,a.jsx)(d.Z,{className:"h-4 w-4 text-blue-500"})]}),(0,a.jsxs)(f.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-500",children:e.filter(e=>e.retryCount<e.maxRetries).length}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Can be retried"})]})]})}),(0,a.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:(0,a.jsxs)(f.Zb,{children:[(0,a.jsxs)(f.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(f.ll,{className:"text-sm font-medium",children:"Unique Workflows"}),(0,a.jsx)(o.Z,{className:"h-4 w-4 text-purple-500"})]}),(0,a.jsxs)(f.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-purple-500",children:I.length}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Affected workflows"})]})]})})]}),(0,a.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:(0,a.jsxs)(f.Zb,{children:[(0,a.jsx)(f.Ol,{children:(0,a.jsx)(f.ll,{children:"Filters"})}),(0,a.jsx)(f.aY,{children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(w.I,{placeholder:"Search by error message...",value:C.search,onChange:e=>D(s=>({...s,search:e.target.value}))})}),(0,a.jsxs)(y.Ph,{value:C.workflow,onValueChange:e=>D(s=>({...s,workflow:e})),children:[(0,a.jsx)(y.i4,{className:"w-[180px]",children:(0,a.jsx)(y.ki,{placeholder:"All Workflows"})}),(0,a.jsxs)(y.Bw,{children:[(0,a.jsx)(y.Ql,{value:"all",children:"All Workflows"}),I.map(e=>(0,a.jsx)(y.Ql,{value:e,children:e},e))]})]}),(0,a.jsxs)(y.Ph,{value:C.taskType,onValueChange:e=>D(s=>({...s,taskType:e})),children:[(0,a.jsx)(y.i4,{className:"w-[180px]",children:(0,a.jsx)(y.ki,{placeholder:"All Task Types"})}),(0,a.jsxs)(y.Bw,{children:[(0,a.jsx)(y.Ql,{value:"all",children:"All Task Types"}),F.map(e=>(0,a.jsx)(y.Ql,{value:e,children:e},e))]})]})]})})]})}),(0,a.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},children:(0,a.jsxs)(f.Zb,{children:[(0,a.jsx)(f.Ol,{children:(0,a.jsx)(f.ll,{children:"Failed Tasks"})}),(0,a.jsx)(f.aY,{children:(0,a.jsx)("div",{className:"rounded-md border",children:(0,a.jsxs)(k.iA,{children:[(0,a.jsx)(k.xD,{children:(0,a.jsxs)(k.SC,{children:[(0,a.jsx)(k.ss,{children:"Task ID"}),(0,a.jsx)(k.ss,{children:"Workflow"}),(0,a.jsx)(k.ss,{children:"Node"}),(0,a.jsx)(k.ss,{children:"Error Type"}),(0,a.jsx)(k.ss,{children:"Failed At"}),(0,a.jsx)(k.ss,{children:"Retries"}),(0,a.jsx)(k.ss,{children:"Actions"})]})}),(0,a.jsx)(k.RM,{children:t?(0,a.jsx)(k.SC,{children:(0,a.jsxs)(k.pj,{colSpan:7,className:"text-center py-8",children:[(0,a.jsx)(l.Z,{className:"h-6 w-6 animate-spin mx-auto mb-2"}),"Loading failed tasks..."]})}):0===S.length?(0,a.jsx)(k.SC,{children:(0,a.jsx)(k.pj,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No failed tasks found"})}):S.map(e=>(0,a.jsxs)(k.SC,{children:[(0,a.jsx)(k.pj,{className:"font-mono text-sm",children:e.id}),(0,a.jsx)(k.pj,{className:"font-medium",children:e.workflowName}),(0,a.jsx)(k.pj,{children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{children:e.nodeName}),(0,a.jsx)(p.C,{variant:"outline",className:"text-xs",children:e.nodeType})]})}),(0,a.jsx)(k.pj,{children:(0,a.jsx)(p.C,{className:"".concat(R(e.error)," text-white"),children:E(e.error)})}),(0,a.jsx)(k.pj,{children:new Date(e.completedAt).toLocaleString()}),(0,a.jsx)(k.pj,{children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("span",{children:[e.retryCount,"/",e.maxRetries]}),e.retryCount>=e.maxRetries&&(0,a.jsx)(p.C,{variant:"destructive",className:"text-xs",children:"Max Exceeded"})]})}),(0,a.jsx)(k.pj,{children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.z,{variant:"ghost",size:"sm",onClick:()=>{alert("Error: ".concat(e.error))},children:(0,a.jsx)(x.Z,{className:"h-4 w-4"})}),e.retryCount<e.maxRetries&&(0,a.jsx)(j.z,{variant:"outline",size:"sm",onClick:()=>A(e.id),disabled:v===e.id,children:(0,a.jsx)(d.Z,{className:"h-4 w-4 ".concat(v===e.id?"animate-spin":"")})}),(0,a.jsx)(j.z,{variant:"ghost",size:"sm",onClick:()=>Z(e.id),className:"text-red-500 hover:text-red-700",children:(0,a.jsx)(h.Z,{className:"h-4 w-4"})})]})})]},e.id))})]})})})]})})]})]})})}}},function(e){e.O(0,[955,298,353,244,888,774,179],function(){return e(e.s=1861)}),_N_E=e.O()}]);